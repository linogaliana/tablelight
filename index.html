<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>R package to reduce memory needs when creating regression tables â€¢ tablelight</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="R package to reduce memory needs when creating regression tables">
<meta property="og:description" content="This package has been designed to strip regression objects
    to reduce memory needs and produce table from this lighter objects.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">tablelight</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">

<div id="tablelight" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#tablelight" class="anchor"></a>tablelight</h1></div>
<!-- badges: start -->

<p>The goal of <code>tablelight</code> is to propose functions to generate regression tables using as little as possible computer resources, especially RAM. This package has been designed because <code>stargazer</code> requires a huge amount of RAM to produce tables with voluminous data.</p>
<p>The basic idea is to <code>strip</code> regression objects from unnecessary fat and use the lightened object to produce a regression table. The package contains two sets of functions:</p>
<ul>
<li>
<code>strip</code> function: a set of methods to remove heavier elements from a regression objects ;</li>
<li>
<code>light_table</code> function: a function to produce <code>LaTeX</code> tables (<code>HTML</code> tables in a future version).</li>
</ul>
<p>The package is organized around a set of methods to extract information from regression objects. The list of regression objects accepted is, for the moment: <code>lm</code>, <code>glm</code>, <code>negbin</code>, <code>oglmx</code>, <code>zeroinfl</code>. Other types of regression objects will be added in the future.</p>
<p>To install this package, you can do</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"linogaliana/tablelight"</span><span class="op">)</span></code></pre></div>
<p>If you want to use the <span class="emoji" data-emoji="package">ðŸ“¦</span></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">tablelight</span><span class="op">)</span></code></pre></div>
<p>Here some examples of regression tables that can be produced with <code>tablelight</code>: <img src="example.gif"></p>
<div id="why-do-you-need-to-strip-fat-from-models-" class="section level2">
<h2 class="hasAnchor">
<a href="#why-do-you-need-to-strip-fat-from-models-" class="anchor"></a>Why do you need to strip fat from models ?</h2>
<p>It is well known that regression objects are heavy in <code>R</code> (see this <a href="http://www.win-vector.com/blog/2014/05/trimming-the-fat-from-glm-models-in-r/">blog post</a> that inspired this package). For instance, the following regression object is about 10 times heavier than the initial data:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1e6</span><span class="op">)</span>,
  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1e6</span><span class="op">)</span>
<span class="op">)</span>
<span class="fu">pryr</span><span class="fu">::</span><span class="fu">object_size</span><span class="op">(</span><span class="va">df</span><span class="op">)</span>
<span class="co">#&gt; 16 MB</span>

<span class="va">regression</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, <span class="va">df</span><span class="op">)</span>
<span class="fu">pryr</span><span class="fu">::</span><span class="fu">object_size</span><span class="op">(</span><span class="va">regression</span><span class="op">)</span>
<span class="co">#&gt; 136 MB</span></code></pre></div>
<p>Producing a regression table with <code>stargazer</code> requires to call <code>summary</code> that asks more RAM:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">profvis</span><span class="op">)</span>
<span class="va">get_required_RAM</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">profvis_object</span><span class="op">)</span><span class="op">{</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">profvis_object</span><span class="op">$</span><span class="va">x</span><span class="op">$</span><span class="va">message</span><span class="op">$</span><span class="va">prof</span><span class="op">$</span><span class="va">memalloc</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">profvis_object</span><span class="op">$</span><span class="va">x</span><span class="op">$</span><span class="va">message</span><span class="op">$</span><span class="va">prof</span><span class="op">$</span><span class="va">memalloc</span><span class="op">)</span>
  <span class="op">)</span>
<span class="op">}</span>
<span class="fu">get_required_RAM</span><span class="op">(</span><span class="fu">profvis</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">regression</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] 30.65924</span></code></pre></div>
<p>To produce a regression table, thatâ€™s a deadly combo: you need to store a heavy regression object in memory and need more memory to summarize it in order to produce the table. With voluminous data, it is easy to make your RAM hit the limit available. The idea behind <code>tablelight</code> is that you just need heavy elements once (to produce standard error values and some fit statistics). Once they have been used, heavy elements can be thrown away.</p>
<p>Most of the pieces to lighten regression objects are described <a href="http://www.win-vector.com/blog/2014/05/trimming-the-fat-from-glm-models-in-r/">there</a>. However, if you want to use <code>stargazer</code> later on, this will be impossible. You lose elements required to be able to run <code>summary</code> and hence produce the result table. A solution has been proposed by the <code>strip</code> package (<a href="https://github.com/paulponcet/strip">here</a>): stripping the object selectively. Unfortunately, this method is only available for <code>lm</code> objects and the weight loss is around 30%</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># install.packages('strip')</span>
<span class="fu">pryr</span><span class="fu">::</span><span class="fu">object_size</span><span class="op">(</span><span class="fu">strip</span><span class="fu">::</span><span class="fu">strip</span><span class="op">(</span><span class="va">regression</span>, keep <span class="op">=</span> <span class="st">"summary"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; 104 MB</span></code></pre></div>
<p>The <code>strip</code> method used in <code>tablelight</code> <span class="emoji" data-emoji="package">ðŸ“¦</span> is more drastic:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">pryr</span><span class="fu">::</span><span class="fu">object_size</span><span class="op">(</span><span class="fu">tablelight</span><span class="fu">::</span><span class="fu"><a href="reference/strip.html">strip</a></span><span class="op">(</span><span class="va">regression</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; 7.34 kB</span></code></pre></div>
<p>Only the elements needed to print a result table are kept. Since using <code>stargazer</code> is no longer possible on a lightened model, <code>tablelight</code> <span class="emoji" data-emoji="package">ðŸ“¦</span> proposes a function (<code><a href="reference/light_table.html">tablelight::light_table</a></code>) to produce nice tables.</p>
</div>
<div id="some-examples" class="section level2">
<h2 class="hasAnchor">
<a href="#some-examples" class="anchor"></a>Some examples</h2>
<div id="general-case" class="section level3">
<h3 class="hasAnchor">
<a href="#general-case" class="anchor"></a>General case</h3>
<p>Letâ€™s say you want to produce a regression table from two objects. For the moment, the freedom in customizing the table is limited but future enhancements will add more and more flexibility.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1e6</span><span class="op">)</span>,
  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1e6</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">df2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1e6</span><span class="op">)</span>,
  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1e6</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">regression1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, <span class="va">df</span><span class="op">)</span>
<span class="va">regression2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, <span class="va">df2</span><span class="op">)</span>

<span class="fu">get_required_RAM</span><span class="op">(</span><span class="fu">profvis</span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/utils/capture.output.html">capture.output</a></span><span class="op">(</span><span class="fu">stargazer</span><span class="fu">::</span><span class="fu">stargazer</span><span class="op">(</span><span class="va">regression1</span>, <span class="va">regression2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span>
<span class="co">#&gt; [1] 0</span></code></pre></div>
<p>With <code>tablelight</code>, you will :</p>
<ol>
<li>Strip an object using <code>strip</code> function ;</li>
<li>Use <code>light_table</code> to produce the output. Models should be provided as a list:</li>
</ol>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">regression1</span> <span class="op">&lt;-</span> <span class="fu">tablelight</span><span class="fu">::</span><span class="fu"><a href="reference/strip.html">strip</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, <span class="va">df</span><span class="op">)</span><span class="op">)</span>
<span class="va">regression2</span> <span class="op">&lt;-</span> <span class="fu">tablelight</span><span class="fu">::</span><span class="fu"><a href="reference/strip.html">strip</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, <span class="va">df2</span><span class="op">)</span><span class="op">)</span>

<span class="fu">get_required_RAM</span><span class="op">(</span><span class="fu">profvis</span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/utils/capture.output.html">capture.output</a></span><span class="op">(</span><span class="fu"><a href="reference/light_table.html">light_table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">regression1</span>, <span class="va">regression2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span>
<span class="co">#&gt; [1] 0</span></code></pre></div>
<p>This is, approximatively, NaN times less memory needed.</p>
<p>The package produces table very similar in appearance with <code>stargazer</code>, for instance:</p>
<p><img src="inst/captures/tab2.png"></p>
</div>
</div>
<div id="specificity-with-zero-inflated-models" class="section level2">
<h2 class="hasAnchor">
<a href="#specificity-with-zero-inflated-models" class="anchor"></a>Specificity with zero inflated models</h2>
<p>It is hard to put together selection and outcome equations in a zero-inflated model with <code>stargazer</code>. Normally, you need to chose between reporting selection or outcome related terms. Sometimes you want to report both together. Unless using a hack with <code>stargazer</code> (see <a href="https://stackoverflow.com/questions/40974843/how-to-report-both-selection-and-outcome-equation-of-selection-models-with-starg">here</a>), this is not possible with <code>stargazer</code>.</p>
<p>This functionality has been integrated into <code>light_table</code> function. For instance, imagine you want to report both selection and outcome equations for a zero-inflated Poisson:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"bioChemists"</span>, package <span class="op">=</span> <span class="st">"pscl"</span><span class="op">)</span>
<span class="va">fm_zip</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/strip.html">strip</a></span><span class="op">(</span><span class="fu">pscl</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pscl/man/zeroinfl.html">zeroinfl</a></span><span class="op">(</span><span class="va">art</span> <span class="op">~</span> <span class="va">.</span> <span class="op">|</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">bioChemists</span><span class="op">)</span><span class="op">)</span>
<span class="va">fm_zinb</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/strip.html">strip</a></span><span class="op">(</span><span class="fu">pscl</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pscl/man/zeroinfl.html">zeroinfl</a></span><span class="op">(</span><span class="va">art</span> <span class="op">~</span> <span class="va">.</span> <span class="op">|</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">bioChemists</span>, dist <span class="op">=</span> <span class="st">"negbin"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>In that case, you will use</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/light_table.html">light_table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">fm_zip</span>, <span class="va">fm_zip</span><span class="op">)</span>,
            type <span class="op">=</span> <span class="st">"html"</span>, 
            modeltype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"selection"</span>,<span class="st">"outcome"</span><span class="op">)</span>,
            dep.var.labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Selection"</span>,<span class="st">"Outcome"</span><span class="op">)</span>,
            stats.var.separate <span class="op">=</span> <span class="fl">2L</span><span class="op">)</span></code></pre></div>
<p><code>stats.var.separate</code> is not compulsory but itâ€™s nicer to get multicolumned performance statistics rather than two times the same.</p>
<p>If you want to compare zero-inflated Poisson and zero-inflated negative binomial models, you can use the following template:</p>
<p><img src="inst/captures/tab3.png"></p>
</div>
</div>
<div id="regression-tables-for-multinomial-logit" class="section level1">
<h1 class="hasAnchor">
<a href="#regression-tables-for-multinomial-logit" class="anchor"></a>Regression tables for multinomial logit</h1>
<p>Another implemented feature is the possibility to put together modulaties of a <em>Y</em> variable in a multinomial logit</p>
<p><img src="inst/captures/tab4.png"></p>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></small></li>
</ul>
</div>
<div class="community">
<h2>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Lino Galiana <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://travis-ci.org/linogaliana/tablelight"><img src="https://travis-ci.org/linogaliana/tablelight.svg?branch=master" alt="Travis build status"></a></li>
<li><a href="https://codecov.io/gh/linogaliana/tablelight?branch=master"><img src="https://codecov.io/gh/linogaliana/tablelight/branch/master/graph/badge.svg" alt="Codecov test coverage"></a></li>
<li><a href="https://gitlab.com/linogaliana/texlight/-/commits/master"><img src="https://gitlab.com/linogaliana/texlight/badges/master/pipeline.svg" alt="pipeline status"></a></li>
<li><a href="https://github.com/linogaliana/tablelight/actions"><img src="https://github.com/linogaliana/tablelight/workflows/R-CMD-check/badge.svg" alt="R build status"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Lino Galiana.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
